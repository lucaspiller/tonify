(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}})();function j(e){const t=[],n=e.replace(/\n/g," ").split(" ");for(const i of n){const r=i.match(/^(\d+)(\.)?(#?)([a-g]|-)?(\d)?$/);if(r){const[,a,o,s,u,l]=r;let v=parseInt(a);o&&(v=v*1.5),t.push({duration:v,pitch:u==="-"?null:(u==null?void 0:u.toUpperCase())??null,octave:l?parseInt(l):2,sharp:s==="#"})}}return t}function G(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var h={VERSION:"3.1.1",HEADER_CHUNK_TYPE:[77,84,104,100],HEADER_CHUNK_LENGTH:[0,0,0,6],HEADER_CHUNK_FORMAT0:[0,0],HEADER_CHUNK_FORMAT1:[0,1],HEADER_CHUNK_DIVISION:[0,128],TRACK_CHUNK_TYPE:[77,84,114,107],META_EVENT_ID:255,META_SMTPE_OFFSET:84},w=(e,t)=>Array(Math.abs(t)+1).join(e);function q(e){return e!==null&&typeof e=="object"&&typeof e.name=="string"}function z(e){return e!==null&&typeof e=="object"&&typeof e.step=="number"&&typeof e.alt=="number"}var A=[0,2,4,-1,1,3,5],Y=A.map(e=>Math.floor(e*7/12));function $(e){const{step:t,alt:n,oct:i,dir:r=1}=e,a=A[t]+7*n;if(i===void 0)return[r*a];const o=i-Y[t]-4*n;return[r*a,r*o]}var _={empty:!0,name:"",pc:"",acc:""},C=new Map,J=e=>"CDEFGAB".charAt(e),X=e=>e<0?w("b",-e):w("#",e),Z=e=>e[0]==="b"?-e.length:e.length;function b(e){const t=JSON.stringify(e),n=C.get(t);if(n)return n;const i=typeof e=="string"?nt(e):z(e)?b(it(e)):q(e)?b(e.name):_;return C.set(t,i),i}var Q=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function tt(e){const t=Q.exec(e);return[t[1].toUpperCase(),t[2].replace(/x/g,"##"),t[3],t[4]]}var et=(e,t)=>(e%t+t)%t,T=[0,2,4,5,7,9,11];function nt(e){const t=tt(e);if(t[0]===""||t[3]!=="")return _;const n=t[0],i=t[1],r=t[2],a=(n.charCodeAt(0)+3)%7,o=Z(i),s=r.length?+r:void 0,u=$({step:a,alt:o,oct:s}),l=n+i+r,v=n+i,f=(T[a]+o+120)%12,d=s===void 0?et(T[a]+o,12)-12*99:T[a]+o+12*(s+1),y=d>=0&&d<=127?d:null,W=s===void 0?null:Math.pow(2,(d-69)/12)*440;return{empty:!1,acc:i,alt:o,chroma:f,coord:u,freq:W,height:d,letter:n,midi:y,name:l,oct:s,pc:v,step:a}}function it(e){const{step:t,alt:n,oct:i}=e,r=J(t);if(!r)return"";const a=r+X(n);return i||i===0?a+i:a}function rt(e){return+e>=0&&+e<=127}function N(e){if(rt(e))return+e;const t=b(e);return t.empty?null:t.midi}var c=function(){function e(){}return e.version=function(){return h.VERSION},e.stringToBytes=function(t){return t.split("").map(function(n){return n.charCodeAt(0)})},e.isNumeric=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},e.getPitch=function(t,n){return n===void 0&&(n="C4"),60-N(n)+N(t)},e.numberToVariableLength=function(t){t=Math.round(t);for(var n=t&127;t=t>>7;)n<<=8,n|=t&127|128;for(var i=[];i.push(n&255),n&128;)n>>=8;return i},e.stringByteCount=function(t){return encodeURI(t).split(/%..|./).length-1},e.numberFromBytes=function(t){var n="",i;return t.forEach(function(r){i=r.toString(16),i.length==1&&(i="0"+i),n+=i}),parseInt(n,16)},e.numberToBytes=function(t,n){n=n||1;var i=t.toString(16);i.length&1&&(i="0"+i);var r=i.match(/.{2}/g),a=r.map(function(o){return parseInt(o,16)});if(a.length<n)for(;n-a.length>0;)a.unshift(0);return a},e.toArray=function(t){return Array.isArray(t)?t:[t]},e.convertVelocity=function(t){return t=t>100?100:t,Math.round(t/100*127)},e.getTickDuration=function(t){if(Array.isArray(t))return t.map(function(a){return e.getTickDuration(a)}).reduce(function(a,o){return a+o},0);if(t=t.toString(),t.toLowerCase().charAt(0)==="t"){var n=parseInt(t.substring(1));if(isNaN(n)||n<0)throw new Error(t+" is not a valid duration.");return n}var i=e.numberFromBytes(h.HEADER_CHUNK_DIVISION),r=i*e.getDurationMultiplier(t);return e.getRoundedIfClose(r)},e.getRoundedIfClose=function(t){var n=Math.round(t);return Math.abs(n-t)<1e-6?n:t},e.getPrecisionLoss=function(t){var n=Math.round(t);return n-t},e.getDurationMultiplier=function(t){if(t==="0")return 0;var n=t.match(/^(?<dotted>d+)?(?<base>\d+)(?:t(?<tuplet>\d*))?/);if(n){var i=Number(n.groups.base),r=i===1||(i&i-1)===0;if(r){var a=i/4,o=1/a,s=n.groups,u=s.dotted,l=s.tuplet;if(u){var v=u.length,f=Math.pow(2,v);o=o+o*((f-1)/f)}if(typeof l=="string"){var d=o*2,y=Number(l||"3");o=d/y}return o}}throw new Error(t+" is not a valid duration.")},e}(),I=function(){function e(t){this.channel=t.channel-1||0,this.controllerValue=t.controllerValue,this.controllerNumber=t.controllerNumber,this.delta=t.delta||0,this.name="ControllerChangeEvent",this.status=176,this.data=c.numberToVariableLength(t.delta).concat(this.status|this.channel,this.controllerNumber,this.controllerValue)}return e}(),V=function(){function e(t){this.delta=t.delta||0,this.name="CopyrightEvent",this.text=t.text,this.type=2;var n=c.stringToBytes(this.text);this.data=c.numberToVariableLength(this.delta).concat(h.META_EVENT_ID,this.type,c.numberToVariableLength(n.length),n)}return e}(),M=function(){function e(t){this.delta=t.delta||0,this.name="CuePointEvent",this.text=t.text,this.type=7;var n=c.stringToBytes(this.text);this.data=c.numberToVariableLength(this.delta).concat(h.META_EVENT_ID,this.type,c.numberToVariableLength(n.length),n)}return e}(),x=function(){function e(t){this.delta=(t==null?void 0:t.delta)||0,this.name="EndTrackEvent",this.type=[47,0],this.data=c.numberToVariableLength(this.delta).concat(h.META_EVENT_ID,this.type)}return e}(),B=function(){function e(t){this.delta=t.delta||0,this.name="InstrumentNameEvent",this.text=t.text,this.type=4;var n=c.stringToBytes(this.text);this.data=c.numberToVariableLength(this.delta).concat(h.META_EVENT_ID,this.type,c.numberToVariableLength(n.length),n)}return e}(),L=function(){function e(t,n){this.name="KeySignatureEvent",this.type=89;var i=n||0;if(t=t||0,typeof n>"u"){var r=[["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"],["ab","eb","bb","f","c","g","d","a","e","b","f#","c#","g#","d#","a#"]],a=t.length,o=t||"C";if(t[0]===t[0].toLowerCase()&&(i=1),a>1)switch(t.charAt(a-1)){case"m":i=1,o=t.charAt(0).toLowerCase(),o=o.concat(t.substring(1,a-1));break;case"-":i=1,o=t.charAt(0).toLowerCase(),o=o.concat(t.substring(1,a-1));break;case"M":i=0,o=t.charAt(0).toUpperCase(),o=o.concat(t.substring(1,a-1));break;case"+":i=0,o=t.charAt(0).toUpperCase(),o=o.concat(t.substring(1,a-1));break}var s=r[i].indexOf(o);t=s===-1?0:s-7}this.data=c.numberToVariableLength(0).concat(h.META_EVENT_ID,this.type,[2],c.numberToBytes(t,1),c.numberToBytes(i,1))}return e}(),P=function(){function e(t){this.delta=t.delta||0,this.name="LyricEvent",this.text=t.text,this.type=5;var n=c.stringToBytes(this.text);this.data=c.numberToVariableLength(this.delta).concat(h.META_EVENT_ID,this.type,c.numberToVariableLength(n.length),n)}return e}(),S=function(){function e(t){this.delta=t.delta||0,this.name="MarkerEvent",this.text=t.text,this.type=6;var n=c.stringToBytes(this.text);this.data=c.numberToVariableLength(this.delta).concat(h.META_EVENT_ID,this.type,c.numberToVariableLength(n.length),n)}return e}(),p=function(){function e(t){this.name="NoteOnEvent",this.channel=t.channel||1,this.pitch=t.pitch,this.wait=t.wait||0,this.velocity=t.velocity||50,this.tick=t.tick||null,this.delta=null,this.data=t.data,this.status=144}return e.prototype.buildData=function(t,n,i){return i===void 0&&(i={}),this.data=[],this.tick?(this.tick=c.getRoundedIfClose(this.tick),t.tickPointer==0&&(this.delta=this.tick)):(this.delta=c.getTickDuration(this.wait),this.tick=c.getRoundedIfClose(t.tickPointer+this.delta)),this.deltaWithPrecisionCorrection=c.getRoundedIfClose(this.delta-n),this.data=c.numberToVariableLength(this.deltaWithPrecisionCorrection).concat(this.status|this.channel-1,c.getPitch(this.pitch,i.middleC),c.convertVelocity(this.velocity)),this},e}(),g=function(){function e(t){this.name="NoteOffEvent",this.channel=t.channel||1,this.pitch=t.pitch,this.velocity=t.velocity||50,this.tick=t.tick||null,this.data=t.data,this.delta=t.delta||c.getTickDuration(t.duration),this.status=128}return e.prototype.buildData=function(t,n,i){return i===void 0&&(i={}),this.tick===null&&(this.tick=c.getRoundedIfClose(this.delta+t.tickPointer)),this.deltaWithPrecisionCorrection=c.getRoundedIfClose(this.delta-n),this.data=c.numberToVariableLength(this.deltaWithPrecisionCorrection).concat(this.status|this.channel-1,c.getPitch(this.pitch,i.middleC),c.convertVelocity(this.velocity)),this},e}(),m=function(){function e(t){this.data=[],this.name="NoteEvent",this.pitch=c.toArray(t.pitch),this.channel=t.channel||1,this.duration=t.duration||"4",this.grace=t.grace,this.repeat=t.repeat||1,this.sequential=t.sequential||!1,this.tick=t.startTick||t.tick||null,this.velocity=t.velocity||50,this.wait=t.wait||0,this.tickDuration=c.getTickDuration(this.duration),this.restDuration=c.getTickDuration(this.wait),this.events=[]}return e.prototype.buildData=function(){var t=this;if(this.data=[],this.grace){var n=1;this.grace=c.toArray(this.grace),this.grace.forEach(function(){var r=new e({pitch:t.grace,duration:"T"+n});t.data=t.data.concat(r.data)})}if(this.sequential)for(var i=0;i<this.repeat;i++)this.pitch.forEach(function(a,o){var s=new p({channel:t.channel,wait:o>0?0:t.wait,delta:o>0?0:c.getTickDuration(t.wait),velocity:t.velocity,pitch:a,tick:t.tick}),u=new g({channel:t.channel,duration:t.duration,velocity:t.velocity,pitch:a});t.events.push(s,u)});else for(var i=0;i<this.repeat;i++)this.pitch.forEach(function(r,a){var o;a==0?o=new p({channel:t.channel,wait:t.wait,delta:c.getTickDuration(t.wait),velocity:t.velocity,pitch:r,tick:t.tick}):o=new p({channel:t.channel,wait:0,delta:0,velocity:t.velocity,pitch:r,tick:t.tick}),t.events.push(o)}),this.pitch.forEach(function(r,a){var o;a==0?o=new g({channel:t.channel,duration:t.duration,velocity:t.velocity,pitch:r,tick:t.tick!==null?c.getTickDuration(t.duration)+t.tick:null}):o=new g({channel:t.channel,duration:0,velocity:t.velocity,pitch:r,tick:t.tick!==null?c.getTickDuration(t.duration)+t.tick:null}),t.events.push(o)});return this},e}(),O=function(){function e(t){this.channel=t.channel||0,this.delta=t.delta||0,this.name="PitchBendEvent",this.status=224;var n=this.scale14bits(t.bend),i=n&127,r=n>>7&127;this.data=c.numberToVariableLength(this.delta).concat(this.status|this.channel,i,r)}return e.prototype.scale14bits=function(t){return t<=0?Math.floor(16384*(t+1)/2):Math.floor(16383*(t+1)/2)},e}(),at=function(){function e(t){this.channel=t.channel||0,this.delta=t.delta||0,this.instrument=t.instrument,this.status=192,this.name="ProgramChangeEvent",this.data=c.numberToVariableLength(this.delta).concat(this.status|this.channel,this.instrument)}return e}(),k=function(){function e(t){this.bpm=t.bpm,this.delta=t.delta||0,this.tick=t.tick,this.name="TempoEvent",this.type=81;var n=Math.round(6e7/this.bpm);this.data=c.numberToVariableLength(this.delta).concat(h.META_EVENT_ID,this.type,[3],c.numberToBytes(n,3))}return e}(),R=function(){function e(t){this.delta=t.delta||0,this.text=t.text,this.name="TextEvent",this.type=1;var n=c.stringToBytes(this.text);this.data=c.numberToVariableLength(t.delta).concat(h.META_EVENT_ID,this.type,c.numberToVariableLength(n.length),n)}return e}(),F=function(){function e(t,n,i,r){this.name="TimeSignatureEvent",this.type=88,this.data=c.numberToVariableLength(0).concat(h.META_EVENT_ID,this.type,[4],c.numberToBytes(t,1),c.numberToBytes(Math.log2(n),1),c.numberToBytes(i||24,1),c.numberToBytes(r||8,1))}return e}(),H=function(){function e(t){this.delta=t.delta||0,this.name="TrackNameEvent",this.text=t.text,this.type=3;var n=c.stringToBytes(this.text);this.data=c.numberToVariableLength(this.delta).concat(h.META_EVENT_ID,this.type,c.numberToVariableLength(n.length),n)}return e}(),U=function(){function e(){this.type=h.TRACK_CHUNK_TYPE,this.data=[],this.size=[],this.events=[],this.explicitTickEvents=[],this.tickPointer=0}return e.prototype.addEvent=function(t,n){var i=this;return c.toArray(t).forEach(function(r,a){if(r instanceof m){if(typeof n=="function"){var o=n(a,r);typeof o=="object"&&Object.assign(r,o)}r.tick!==null?i.explicitTickEvents.push(r):r.buildData().events.forEach(function(s){return i.events.push(s)})}else i.events.push(r)}),this},e.prototype.buildData=function(t){var n=this;t===void 0&&(t={}),this.data=[],this.size=[],this.tickPointer=0;var i=0;return this.events.forEach(function(r){if(r instanceof p||r instanceof g){var a=r.buildData(n,i,t);i=c.getPrecisionLoss(r.deltaWithPrecisionCorrection||0),n.data=n.data.concat(a.data),n.tickPointer=c.getRoundedIfClose(r.tick)}else r instanceof k&&(n.tickPointer=c.getRoundedIfClose(r.tick)),n.data=n.data.concat(r.data)}),this.mergeExplicitTickEvents(),(!this.events.length||!(this.events[this.events.length-1]instanceof x))&&(this.data=this.data.concat(new x().data)),this.size=c.numberToBytes(this.data.length,4),this},e.prototype.mergeExplicitTickEvents=function(){var t=this;this.explicitTickEvents.length&&(this.explicitTickEvents.sort(function(n,i){return n.tick-i.tick}),this.explicitTickEvents.forEach(function(n){n.buildData().events.forEach(function(i){return i.buildData(t)}),n.events.forEach(function(i){return t.mergeSingleEvent(i)})}),this.explicitTickEvents=[],this.buildData())},e.prototype.mergeTrack=function(t){var n=this;return this.buildData(),t.buildData().events.forEach(function(i){return n.mergeSingleEvent(i)}),this},e.prototype.mergeSingleEvent=function(t){if(!this.events.length){this.addEvent(t);return}for(var n,i=0;i<this.events.length&&!(this.events[i].tick>t.tick);i++)n=i;var r=n+1;t.delta=t.tick-this.events[n].tick,this.events.splice(r,0,t);for(var i=r+1;i<this.events.length;i++)this.events[i].delta=this.events[i].tick-this.events[i-1].tick},e.prototype.removeEventsByName=function(t){var n=this;return this.events.forEach(function(i,r){i.name===t&&n.events.splice(r,1)}),this},e.prototype.setTempo=function(t,n){return n===void 0&&(n=0),this.addEvent(new k({bpm:t,tick:n}))},e.prototype.setTimeSignature=function(t,n,i,r){return this.addEvent(new F(t,n,i,r))},e.prototype.setKeySignature=function(t,n){return this.addEvent(new L(t,n))},e.prototype.addText=function(t){return this.addEvent(new R({text:t}))},e.prototype.addCopyright=function(t){return this.addEvent(new V({text:t}))},e.prototype.addTrackName=function(t){return this.addEvent(new H({text:t}))},e.prototype.addInstrumentName=function(t){return this.addEvent(new B({text:t}))},e.prototype.addMarker=function(t){return this.addEvent(new S({text:t}))},e.prototype.addCuePoint=function(t){return this.addEvent(new M({text:t}))},e.prototype.addLyric=function(t){return this.addEvent(new P({text:t}))},e.prototype.polyModeOn=function(){var t=new p({data:[0,176,126,0]});return this.addEvent(t)},e.prototype.setPitchBend=function(t){return this.addEvent(new O({bend:t}))},e.prototype.controllerChange=function(t,n,i,r){return this.addEvent(new I({controllerNumber:t,controllerValue:n,channel:i,delta:r}))},e}(),ot=function(){function e(){}return e.prototype.trackFromVoice=function(t,n){var i=this;n===void 0&&(n={addRenderedAccidentals:!1});var r=new U,a=[];return t.tickables.forEach(function(o){o.noteType==="n"?(r.addEvent(new m({pitch:o.keys.map(function(s,u){return i.convertPitch(s,u,o,n.addRenderedAccidentals)}),duration:i.convertDuration(o),wait:a})),a=[]):o.noteType==="r"&&a.push(i.convertDuration(o))}),a.length>0&&r.addEvent(new m({pitch:"[c4]",duration:"0",wait:a,velocity:"0"})),r},e.prototype.convertPitch=function(t,n,i,r){var a;r===void 0&&(r=!1);var o=t.split("/"),s=o[0].substring(1).replace("n","");return r&&((a=i.getAccidentals())===null||a===void 0||a.forEach(function(u){u.index===n&&(u.type==="n"?s="":s+=u.type)})),o[0][0]+s+o[1]},e.prototype.convertDuration=function(t){return"d".repeat(t.dots)+this.convertBaseDuration(t.duration)+(t.tuplet?"t"+t.tuplet.num_notes:"")},e.prototype.convertBaseDuration=function(t){switch(t){case"w":return"1";case"h":return"2";case"q":return"4";default:return t}},e}(),ct=function(){function e(t){this.type=h.HEADER_CHUNK_TYPE;var n=t>1?h.HEADER_CHUNK_FORMAT1:h.HEADER_CHUNK_FORMAT0;this.data=n.concat(c.numberToBytes(t,2),h.HEADER_CHUNK_DIVISION),this.size=[0,0,0,this.data.length]}return e}(),st=function(){function e(t,n){n===void 0&&(n={}),this.tracks=c.toArray(t),this.options=n}return e.prototype.buildData=function(){var t=this,n=[];return n.push(new ct(this.tracks.length)),this.tracks.forEach(function(i){n.push(i.buildData(t.options))}),n},e.prototype.buildFile=function(){var t=[];return this.buildData().forEach(function(n){return t=t.concat(n.type,n.size,n.data)}),new Uint8Array(t)},e.prototype.base64=function(){if(typeof btoa=="function"){for(var t="",n=this.buildFile(),i=n.byteLength,r=0;r<i;r++)t+=String.fromCharCode(n[r]);return btoa(t)}return Buffer.from(this.buildFile()).toString("base64")},e.prototype.dataUri=function(){return"data:audio/midi;base64,"+this.base64()},e.prototype.setOption=function(t,n){return this.options[t]=n,this},e.prototype.stdout=function(){return process.stdout.write(Buffer.from(this.buildFile()))},e}(),ut={Constants:h,ControllerChangeEvent:I,CopyrightEvent:V,CuePointEvent:M,EndTrackEvent:x,InstrumentNameEvent:B,KeySignatureEvent:L,LyricEvent:P,MarkerEvent:S,NoteOnEvent:p,NoteOffEvent:g,NoteEvent:m,PitchBendEvent:O,ProgramChangeEvent:at,TempoEvent:k,TextEvent:R,TimeSignatureEvent:F,Track:U,TrackNameEvent:H,Utils:c,VexFlow:ot,Writer:st},ht=ut;const E=G(ht);function lt(e,t,n){const i=new E.Track;i.setTempo(t),i.addEvent(new E.ProgramChangeEvent({instrument:80}));const r={C:60,"C#":61,D:62,"D#":63,E:64,F:65,"F#":66,G:67,"G#":68,A:69,"A#":70,B:71};let a=0;for(let s=0;s<e.length;s++){const u=e[s],l=Math.round(512/u.duration);if(u.pitch===null)a+=l;else{let v=u.pitch+(u.sharp?"#":""),f=r[v]+(u.octave-4+n)*12;f=Math.min(Math.max(f,0),127);const d={pitch:f,duration:`T${l}`,velocity:127};a>0&&(d.wait=`T${a}`,a=0),i.addEvent(new E.NoteEvent(d))}}return a+=Math.round(512/4),i.addEvent(new E.NoteEvent({wait:`T${a}`,pitch:[0],duration:"T0",velocity:0})),new E.Writer([i]).buildFile()}document.getElementById("ringtone").value=`4g2 8#a2 16g2 16- 16g2
8c3 8g2 8f2 4g2 8d3
16g2 16- 16g2 8#d3 8d3
8#a2 8g2 8d3 8g3 16g2
16f2 16- 16f2 8d2 8a2
2g2`;const D=document.getElementById("player"),K=()=>{try{const e=document.getElementById("ringtone").value,t=parseInt(document.getElementById("tempo").value,10),n=parseInt(document.getElementById("octaveShift").value,10),i=j(e),r=lt(i,t,n),a=new Blob([r],{type:"audio/midi"});return URL.createObjectURL(a)}catch(e){console.error("Error converting ringtone to MIDI: ",e)}};document.getElementById("convert-button").addEventListener("click",()=>{const e=K();D.src=e,setTimeout(()=>{D.start()},1e3)});document.getElementById("download-button").addEventListener("click",()=>{const e=K(),t=document.createElement("a");t.style.display="none",t.href=e,t.download="ringtone.mid",document.body.appendChild(t),t.click()});
